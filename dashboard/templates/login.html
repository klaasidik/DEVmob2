<script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-auth.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

<script>
    const firebaseConfig = {
  apiKey: "AIzaSyCmTIcFGpM7Dvue4AaveWy7X4iSozsKnto",
  authDomain: "dashboard-101c3.firebaseapp.com",
  projectId: "dashboard-101c3",
  storageBucket: "dashboard-101c3.appspot.com",
  messagingSenderId: "118658510273",
  appId: "1:118658510273:web:ff980148890cdcef801340",
  measurementId: "G-ZB3C7WL2MS"
};
firebase.initializeApp(firebaseConfig);

function googleLogin() {
  var provider = new firebase.auth.GoogleAuthProvider();
  firebase.auth().signInWithPopup(provider).then(function(result) {
    var token = result.credential.accessToken;

    // Envoyer le token au serveur Django pour vérification
    $.ajax({
      url: '/chemin/vers/custom_login_view',
      method: 'POST',
      data: {
        'token': token
      },
      success: function(response) {
        console.log('Réponse du serveur :', response);
        if(response.status === 'success') {
          console.log('Token décodé :', response.decoded_token);
        } else {
          console.error('Erreur lors de la connexion :', response.message);
        }
      },
      error: function(error) {
        console.error('Erreur AJAX :', error);
      }
    });
  }).catch(function(error) {
    console.log('Erreur Firebase Auth :', error);
  });
}
</script>

<h2>Login</h2>
<form method="post">
    {% csrf_token %}
    {{ form.as_p }}
    <button type="submit">Login</button>
</form>
<button onclick="googleLogin()">Connexion avec Google</button>